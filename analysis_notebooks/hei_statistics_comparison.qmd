---
title: "Comparison of Sample with HEI statistics"
author:
  - "Eva Kormann"
  - "Thomas Klebel"
format: html
editor: visual
execute: 
  echo: false
---

## 

```{r}

library(here)
library(tidyverse)
library(readxl)
library(janitor)
library(fuzzyjoin)


df <- read_csv(here("data", "processed", "preprocessed_data.csv"))


path21 <- here("data", "additional", "hei_stats", "vfpo_Ukr_2021_translated.xlsx")
path22 <- here("data", "additional", "hei_stats", "vfpo_Ukr_2022_translated.xlsx")
path23 <- here("data", "additional", "hei_stats", "vfpo_Ukr_2023_translated.xlsx")

# Read in all sheets of one file into a list
# sheets <- excel_sheets(path2021)
# stats2021 <- lapply(sheets, function(X) read_excel(path2021, sheet = X))
```

```{r}
regions21 <- read_excel(path21, " 2.6", skip = 3) %>% 
  na.omit() %>% 
  rename(
    region = ...1,
    total21 = ...2
  ) %>%
  filter(region != "Ukraine") %>% 
  select(c(region, total21))

regions22 <- read_excel(path22, " 2.6", skip = 3) %>% 
  na.omit() %>% 
  rename(
    region = ...1,
    total22 = ...2
  ) %>%
  filter(region != "Ukraine") %>% 
  select(c(region, total22))

regions23 <- read_excel(path23, " 2.6", skip = 3) %>% 
  na.omit() %>% 
  rename(
    region = ...1,
    total23 = ...2
  ) %>%
  filter(region != "Ukraine") %>% 
  select(c(region, total23))
```

```{r}
regions_stats <- merge(regions21, regions22, by = "region") %>% 
  merge(., regions23, by = "region")

knitr::kable(regions_stats, format = "html")
```

```{r}
regions_df <- df %>% 
  tabyl(X55, X64) %>% 
  adorn_percentages("col") %>% 
  adorn_pct_formatting(digits = 1) %>% 
  adorn_ns()

knitr::kable(regions_df, format = "html")
```
